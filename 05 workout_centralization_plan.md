# 운동 기록 표시 로직 중앙 관리 및 일원화 계획 (완료 보고)

## 1. 기본 원칙 (Core Principle)
- **대시보드 벤치마킹:** 현재 의도대로 가장 잘 표현되고 있는 `lib/screens/dashboard_screen.dart`의 `_buildWorkoutItem` 디자인과 로직을 표준으로 삼습니다.
- **위젯화 및 재사용:** 표준화된 단일 위젯(`WorkoutItemCard`)을 생성하고, 이를 **대시보드**, **상세 피드(주/월/연/레이스)**, **캘린더**에서 동일하게 호출합니다.
- **데이터 통합:** PaceLifter 내부 기록(`WorkoutSession`)과 외부 연동 기록(`HealthDataPoint`)을 `WorkoutDataWrapper`를 통해 완벽히 통합하여 표시합니다.

## 2. 세부 구현 전략 (완료)

### 2.1 중앙 데이터 엔진: `WorkoutUIUtils` 확장
각 화면에서 파편화되어 있던 데이터 판별 로직을 `WorkoutUIUtils`로 완전히 이관했습니다.
- **통합 정보 추출:** `getWorkoutDisplayInfo` 메서드를 통해 데이터 소스 판별, 이름 포맷팅, 색상/아이콘 결정을 한 곳에서 처리합니다.
- **카테고리 판별:** `Strength`, `Endurance`, `Hybrid` 및 코어/기능성 특수 로직을 일원화했습니다.
- **디스플레이 모델 도입:** 가공된 UI 데이터를 안전하게 전달하기 위한 `WorkoutDisplayInfo` 모델을 추가했습니다.

### 2.2 공통 UI 컴포넌트: `WorkoutItemCard`
대시보드의 고품질 디자인을 모든 화면에서 재사용할 수 있도록 독립 위젯으로 분리했습니다.
- **구조:** `Card` -> `ListTile` 기반의 표준 레이아웃 적용.
- **디자인 일관성:** 모든 화면이 동일한 위젯을 사용함으로써 시각적 파편화를 방지합니다.

## 3. 리팩토링 결과 (Execution Results)

### 3.1 중앙화된 파일 구조
- **Model:** `lib/models/workout_display_info.dart` (UI용 데이터 구조체)
- **Logic:** `lib/utils/workout_ui_utils.dart` (데이터 가공 엔진)
- **UI:** `lib/widgets/workout_item_card.dart` (공통 카드 위젯)

### 3.2 코드 감소 및 최적화 성과
- **총합:** 약 **260+ 라인의 중복 코드 제거** 및 유지보수 포인트 단일화.

## 4. 기대 효과 및 향후 관리
- **완벽한 디자인 일관성:** 모든 화면에서 동일한 아이콘, 제목, 색상 적용.
- **유지보수 효율 극대화:** `WorkoutUIUtils` 수정만으로 앱 전체 대응 가능.

## 5. 중앙화 고도화 (정책의 일원화)

### 5.1 문제 발견 (Issue)
위젯 중앙화 이후에도 특정 화면(상세 피드, 캘린더)에서 대시보드와 표시 형식이 미세하게 다른 현상이 발견되었습니다.
- **예시:** LSD 러닝 시 대시보드는 [제목: 러닝 / 뱃지: LSD]로 표시되나, 상세 피드는 [제목: LSD / 뱃지 없음]으로 표시됨.

### 5.2 원인 분석 (Root Cause)
- **파라미터의 파편화:** `WorkoutItemCard`가 `activityOnly`와 같은 표시 정책 결정 파라미터를 외부에 노출하고 있었습니다.
- **화면별 개별 설정:** 각 화면이 위젯을 호출할 때 서로 다른 파라미터 값을 전달함으로써, 위젯은 같지만 '표시 정책'은 여전히 파편화된 상태로 남았습니다.

### 5.3 해결 전략 (Proposed Solution)
진정한 의미의 중앙화를 위해 **'표시 정책(Policy)' 자체를 엔진 내부로 가둡니다.**
- **파라미터 제거:** 위젯 및 유틸리티에서 `activityOnly` 등 화면별 분기를 만드는 파라미터를 삭제합니다.
- **표준 정책 강제:** `WorkoutUIUtils.getWorkoutDisplayInfo` 내부에서 **"제목은 무조건 활동명(러닝/웨이트), 세부 명칭은 무조건 뱃지"**라는 대시보드 표준 원칙을 고정하여 모든 화면에 강제로 적용합니다.
- **데이터 정합성 강화:** 캘린더 등 다양한 데이터 소스 환경에서도 템플릿 정보를 누락 없이 추출할 수 있도록 엔진 내부의 우선순위 로직을 보강합니다.